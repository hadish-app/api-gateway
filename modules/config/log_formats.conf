# Main extended log format
log_format main_ext escape=json '[$timestamp] "$remote_addr" - "$remote_user" '
                    '"$request" "$status" "$body_bytes_sent" '
                    '"$http_referer" "$http_user_agent" '
                    '"forwarded_for":"$http_x_forwarded_for" '
                    '"req_time":"$request_time" '
                    '"upstream_time":"$upstream_response_time" '
                    '"upstream_status":"$upstream_status" '
                    '"host":"$host" '
                    '"server_port":"$server_port" '
                    '"request_id":"$request_id"';

# Security events log format
log_format security escape=json '[$timestamp] "$remote_addr" '
                    '"client":"$http_user_agent" '
                    '"forwarded_for":"$http_x_forwarded_for" '
                    '"request":"$request" '
                    '"status":"$status" '
                    '"violation_type":"$violation_type" '
                    '"details":"$details" '
                    '"request_id":"$request_id"'; 