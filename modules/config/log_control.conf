# Map for logging 4xx and 5xx errors
map $status $status_requires_security_log {
    ~^[45] 1;        # Log all 4xx and 5xx errors
    default 0;
}

# Map for security violations
map $violation_type $has_security_violation {
    ""      0;       # No security logging for empty violation type
    default 1;       # Log when violation type is set
}

# Combined condition for security logging
map "$status_requires_security_log$has_security_violation" $log_security {
    "~1" 1;         # Log if either condition is true
    default 0;
} 