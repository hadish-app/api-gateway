-- TODO: Implement metrics collection middleware. Store metrics in a shared dictionary.