# Lua Configuration
# -----------------------------------------------------------------------------
# Module search paths
lua_package_path "/usr/local/openresty/lualib/?.lua;/usr/local/openresty/nginx/modules/?.lua;/usr/local/openresty/nginx/modules/*/?.lua;;";

# Shared memory zones
lua_shared_dict metrics 10m;           # Metrics storage
lua_shared_dict rate_limit_store 10m;  # Rate limiting storage
lua_shared_dict config 1m;             # Configuration storage

# Lua initialization
init_by_lua_block {
    -- Initialize UUID generator
    local uuid = require "resty.jit-uuid"
    uuid.seed()  -- Properly seed the UUID generator
}

init_worker_by_lua_block {
    -- Initialize rate limiter
    local rate_limit = require "middleware.rate_limit"
    rate_limit.init()
} 