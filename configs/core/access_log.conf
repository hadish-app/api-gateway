# =============================================================================
# HTTP Context Logging Configuration
# =============================================================================

# Log formats for different purposes
# Machine-readable format (JSON)
log_format json_main escape=json '{'
    '"timestamp":"$time_iso8601",'
    '"client":"$remote_addr",'
    '"user":"$remote_user",'
    '"request":"$request",'
    '"status":$status,'
    '"bytes_sent":$body_bytes_sent,'
    '"referer":"$http_referer",'
    '"user_agent":"$http_user_agent",'
    '"forwarded_for":"$http_x_forwarded_for",'
    '"request_time":$request_time'
    '}';

# Detailed human-readable format
log_format detailed '$remote_addr - $remote_user [$time_iso8601] "$request" '
                    '$status $body_bytes_sent "$http_referer" '
                    '"$http_user_agent" "$http_x_forwarded_for" '
                    'rt=$request_time ua="$http_user_agent" '
                    'forwarded="$http_x_forwarded_for"';

# Brief format for quick debugging
log_format brief '[$time_iso8601] $request_method $uri -> $status ($request_time sec)';

# Access logs with different formats
access_log /usr/local/openresty/nginx/logs/access.log json_main;
access_log /usr/local/openresty/nginx/logs/access.human.log detailed;
access_log /usr/local/openresty/nginx/logs/access.brief.log brief;
access_log /dev/stdout brief; 