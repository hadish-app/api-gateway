name: hadish
services:
  nginx:
    image: openresty/openresty:alpine
    container_name: api-gateway
    env_file:
      - .env
    ports:
      - "${API_GATEWAY_PORT}:80"
    volumes:
      - ./configs/nginx.conf:/usr/local/openresty/nginx/conf/nginx.conf:ro
      - ./configs/banned_ips.conf:/etc/nginx/banned_ips.conf
      - ./logs:/var/log/nginx
      - ./modules:/usr/local/openresty/nginx/modules:ro
    restart: unless-stopped
    networks:
      - core-api-gateway-private
    # Security settings
    security_opt:
      - no-new-privileges:true

networks:
  core-api-gateway-private:
    driver: bridge
    external: true
